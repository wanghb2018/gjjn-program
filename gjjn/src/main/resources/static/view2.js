var allRoleSJ=null;var allMap=null;var allJunxian=null;var allKeyanSJ=null;var guajiid=null;var role=null;$(function(){$.get("allRoleSJ",function(a){allRoleSJ=a});$.get("allGameMap",function(a){allMap=a});$.get("allJunxian",function(a){allJunxian=a});$.get("allKeyanSj",function(a){allKeyanSJ=a});$(".select_jn").on("click",function(){$(".select_jn").removeClass("cjjs_jnimg_xuanzhong");$(".select_jn").addClass("cjjs_jnimg");$(this).addClass("cjjs_jnimg_xuanzhong");var a=$(this).attr("id");$("#selectedId").val(a);if(a=="jnimg1"){$("#jnworld").html("本森级驱逐舰拉菲听候您的吩咐……指挥官，这个耳朵不是真的，请不要再盯着看了……")}else{if(a=="jnimg2"){$("#jnworld").html("我是标枪，指挥官指挥官，请多指教啦～欸嘿嘿，因为在意的女生突然自己加入到手下来，不知所措了？")}else{$("#jnworld").html("我还以为你从来都不会选我呢。")}}});$("input[name='phbtype']").change(function(){getphbinfo($("input[name='phbtype']:checked").val())})});function register(){var d=$("#reg_username").val().trim();var b=$("#reg_password").val().trim();var c=$("#reg_password1").val().trim();var a=$("#reg_Email").val().trim();if(d.length<5||d.length>20){mui.toast("帐号必须为5-20位字符，不含特殊字符！");return}if(b.length<5||b.length>20){mui.toast("密码必须为5-20位字符，不含特殊字符！");return}if(b!=c){mui.toast("认真点，两次密码都不一致啦，是不是撸多了？");return}if(a==""||!/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/.test(a)){mui.toast("邮箱找回密码很重要的说，记得要填写哦！");return}mui.post("register",{"userName":d,"password":b,"email":a},function(e){if(e==0){mui.toast("注册成功！");$("#reg").hide();$("#cjrole").show()}else{if(e==-1){mui.toast("该帐号已存在！")}}},"json")}function login(b){if(b=="post"){var c=$("#login_username").val().trim();var a=$("#login_password").val().trim();if(c.length<5||c.length>20){mui.toast("帐号必须为5-20位字符，不含特殊字符！");return}if(a.length<5||a.length>20){mui.toast("密码必须为5-20位字符，不含特殊字符！");return}mui.post("login",{"userName":c,"password":a},function(d){if(d.hr==0){$("#login").hide();if(d.data!=null){$("#zhop").hide();$("#mainview").show();renderRoleDuiwuWithData(d.data);rendermap(d.data.openmapId,d.data.guajimapId);guajiid=d.data.guajimapId;role=d.data}else{$("#login").hide();$("#cjrole").show()}}else{if(d.hr==-1){mui.toast("帐号或密码错误，请核对喔~")}}},"json")}else{$.get("login",function(d){if(d.hr==0){$("#login").hide();if(d.data!=null){$("#zhop").hide();$("#mainview").show();renderRoleDuiwuWithData(d.data);rendermap(d.data.openmapId,d.data.guajimapId);guajiid=d.data.guajimapId;role=d.data}else{$("#cjrole").show()}}else{$("#login").show()}})}}function logout(){mui.get("logout",function(a){if(a==0){$("#mainview").hide();$("#zhop").show();$("#login").show()}},"json")}function changepasswd(){var d=$("#cpd_username").val().trim();var b=$("#cpd_password").val().trim();var c=$("#cpd_password1").val().trim();var a=$("#cpd_Email").val().trim();if(d.length<5||d.length>20){mui.toast("帐号必须为5-20位字符，不含特殊字符！");return}if(a==""||!/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/.test(a)){mui.toast("邮箱格式都输不对，看来是不想修改密码啦！");return}if(b.length<5||b.length>20){mui.toast("密码必须为5-20位字符，不含特殊字符！");return}if(b!=c){mui.toast("认真点，两次密码都不一致啦，是不是撸多了？");return}mui.post(domain+"changePassword/",{"userName":d,"password":b,"email":a},function(e){if(e==0){$("#changepasswdview").hide();$("#login").show()}else{if(e==1){mui.toast("该帐号不存在！")}else{if(dat==-1){mui.toast("邮箱不正确喔！")}}}},"json")}function Button_div_login(a){if(a=="reg"){$("#login").hide();$("#reg").show()}else{if(a=="login"){$("#reg").hide();$("#changepasswdview").hide();$("#login").show()}else{$("#login").hide();$("#changepasswdview").show()}}}function createrole(){jnid=$("#selectedId").val();rolename=$("#cjrole_zhgname").val().trim();if(jnid==""){mui.toast("请选择初始舰娘！");return}if(rolename==""||rolename.length>6){mui.toast("指挥官名称不能为空，且必须在6个字符以内");return}mui.post("createRole",{"jnImgId":jnid,"roleName":rolename},function(a){if(a){location.reload();$("#zhop").hide();$("#mainview").show();renderRoleData(a)}})}function mapguaji(a){guajiid=a;$(".gjbtn").removeClass("mychujibutton");$(".gjbtn").text("挂机");$("#mapbtn"+a).addClass("mychujibutton");$("#mapbtn"+a).text("结算");$("#mapbtn"+a).attr("disabled",true);mui.get("mapJiesuan",{"id":a},function(d){if(d.hr==0){$("#roleguajitime").html(formatDate(d.data.guajitime));var c=d.data.sec;day=parseInt(c/86400);hour=parseInt(c%86400/3600);min=parseInt(c%86400%3600/60);second=c-86400*day-hour*3600-min*60;var e="";if(day>0){e=e+day+"天"}if(hour>0){e=e+hour+"小时"}if(min>0){e=e+min+"分钟"}if(second>0){e=e+second+"秒"}var f="<font color='white'>挂机时间"+e+"</font><br /><font color='green'>获得经验："+d.data.jy+"<font><br/><font color='gold'>获得物资"+d.data.wz+"</font><br/>";if(d.data.sps){for(var b=0;b<d.data.sps.length;b++){f=f+"<font color='"+d.data.sps[b].color+"'>"+d.data.sps[b].name+"碎片"+d.data.sps[b].num+"个、</font>"}}mui.toast(f,{duration:"long",type:"div"});$("#wz_num").html(parseInt($("#wz_num").html())+d.data.wz);renderRoleDuiwu()}else{if(d.hr==-1){mui.toast("时间过短")}}$("#mapbtn"+a).attr("disabled",false)})}function mapboss(a){$.get("mapBoss",{"id":a},function(c){if(c.hr==0||c.hr==1){if(c.hr==1){rendermap(c.data.openId,c.data.guajiId)
}var d="<font color='yellow'>挑战成功！</font><br/><font color='white'>恭喜您获得以下奖励：</font><br/><font color='yellow'>指挥官经验："+c.data.zhgjy+"</font><br/><font color='green;'>舰娘经验："+c.data.jnjy+"</font><br/><font color='gold'>物资："+c.data.wz+"</font>";if(c.data.sps){for(var b=0;b<c.data.sps.length;b++){d=d+"<br/><font color='"+c.data.sps[b].color+"'>"+c.data.sps[b].name+"碎片："+c.data.sps[b].num+"个</font>"}}mui.toast(d,{duration:"short",type:"div"});$("#wz_num").html(parseInt($("#wz_num").html())+c.data.wz)}else{if(c.hr==-1){mui.toast("胜败乃兵家常事，大虾请提升战力后再来！")}else{mui.toast("哥哥，没油了！")}}})}function rolejinjie(){if(role.level%10!=0){mui.toast("整十级才能进阶！");return}mui.confirm("确定要消耗"+allRoleSJ[role.level-1].needwz+"物资进行进阶？","提示",["取消","确定"],function(a){if(a.index==1){mui.get("jinjie",function(b){if(b==0){var c="升阶成功！<br/>您的军衔已提升至<font color='gold'>"+allJunxian[role.junxianId].label+"</font><br/>并开放等级上限：<font color='green'>"+(role.djsx+10)+"级</font><br/>舰队全属性提升5%";mui.toast(c,{duration:"long",type:"div"});renderRoleDuiwu()}else{if(b==1){mui.toast("物资不足")}else{mui.toast("等级或经验不足")}}})}})}function salesuipian(c,a){var b=mui("#numbox"+c).numbox().getValue();if(b>0){mui.confirm("确定要出售"+b+"个碎片换取魔方？","提示",["取消","确定"],function(d){if(d.index==1){mui.get("saleSuipian",{"id":c,"num":b},function(e){if(e){var f="<font color='gold'>获得魔方"+e+"个</font>";mui.toast(f,{duration:"long",type:"div"})}showsplist()})}})}else{if(a>3){mui.confirm("确定要全部出售该碎片？","提示",["取消","确定"],function(d){if(d.index==1){mui.get("saleSuipian",{"id":c,"num":-1},function(e){if(e){var f="<font color='gold'>获得魔方"+e+"个</font>";mui.toast(f,{duration:"long",type:"div"})}$("#splistid"+c).hide()})}})}else{mui.get("saleSuipian",{"id":c,"num":-1},function(d){if(d){var e="<font color='gold'>获得魔方"+d+"个</font>";mui.toast(e,{duration:"long",type:"div"})}$("#splistid"+c).hide()})}}}function renderRoleDuiwu(b){if(b){$("#jianduiview").show();$("#jianniangview").hide();$("#cangkuview").hide();$("#chujiview").hide();$("#caidanview").hide()}renderRoleDuiwuWithData(null)}function renderRoleDuiwuWithData(a){if(a){renderRoleData(a)}else{$.get("getRoleInfo",function(b){role=b;renderRoleData(b)})}getAndRenderDuiwu()}function getAndRenderDuiwu(){$.get("getDuiwuInfo",function(a){renderduiwu(a)})}function renderRoleData(a){if(a){$("#rolename").html(a.rolename);$("#rolelevel").html("Lv."+a.level);$("#roletouxiang").attr("src",a.touxiang);$("#zs_num").html(a.zuanshi);$("#wz_num").html(a.wuzi);$("#roleid").html(a.id);$("#rolejunxian").html(allJunxian[a.junxianId-1].label);$("#roleshiyou").html(a.shiyou);$("#rolemofang").html(a.mofang);$("#rolekeyandian").html(a.keyandian);$("#roleexp").html(a.exp);$("#roleexprate").html((a.exp/allRoleSJ[a.level-1].needjy*100).toFixed(2)+"%");$("#rolesj").html(allRoleSJ[a.level-1].needjy);$("#roleguajitime").html(formatDate(a.guajitime))}}function renderduiwu(a){var c="";if(a.myJns){for(var b=0;b<a.myJns.length;b++){c=c+"<li class='mui-table-view-cell mui-media'><div style='float: left;'><img class='mui-media-object mui-pull-left' src='"+a.myJns[b].touxiang+"'><div class='mui-media-body'><font color='"+a.myJns[b].color+"'>"+a.myJns[b].name+"</font><p class='mui-ellipsis'><font color='white'>Lv."+a.myJns[b].level+"</font><font style='margin-left: 5px;' color='white'>战斗力："+a.myJns[b].zdl+"</font></p></div></div><div style='float: right;'><button type='button' class='imglibutton mui-btn' onclick='jnxiuxi("+a.myJns[b].id+")'>休息</button> <button type='button' class='imglibutton mui-btn' onclick='jninfoview("+a.myJns[b].id+")'>查看</button></div></li>"}}$("#rolezdl").html(a.zdl);$("#mydwlist").empty();$("#mydwlist").html(c)}function rendermap(a,d){var c="";for(var b=0;b<a;b++){c=c+"<li class='mui-table-view-cell' id='mapid_"+allMap[b].id+"'><div style='float: left;'><div><font color='#FFCC00'>"+allMap[b].place+"-"+allMap[b].point+" "+allMap[b].label+"</font><p class='myp mui-ellipsis'>推荐战力：<span>"+allMap[b].zdl+"</span></p></div></div><div style='float: right;'><button id='mapbtn"+allMap[b].id+"' type='button' class='mui-btn gjbtn' onclick='mapguaji("+allMap[b].id+")'>挂机</button> <button id='mapbtnboss"+allMap[b].id+"' type='button' class='mui-btn' onclick='mapboss("+allMap[b].id+")'>BOSS</button></div></li>"}$("#mapul").empty();$("#mapul").html(c);if(d){$("#mapbtn"+d).addClass("mychujibutton");$("#mapbtn"+d).text("结算")}$("#roleguajijy").html(allMap[a-1].jnjy)}function showjnlist(){$("#jianduiview").hide();$("#jianniangview").show();$("#cangkuview").hide();$("#chujiview").hide();$("#caidanview").hide();$.get("showJnList",function(c){if(c){var a="";for(var b=0;b<c.length;b++){a=a+"<img src='"+c[b].touxiang+"' class='jntxlist' style='border: 3px "+c[b].color+" solid' onclick='showjninfo2("+c[b].id+")'/> "}$("#jnlistdiv").empty();$("#jnlistdiv").html(a)}})}function showsplist(b){if(b){$("#jianduiview").hide();$("#jianniangview").hide();$("#cangkuview").show();$("#chujiview").hide();$("#caidanview").hide()}mui.get("showSpList",function(d){if(d){$("#zbl").html(d[0].num);$("#jbl").html(d[1].num);
var c="";for(var a=2;a<d.length;a++){c=c+"<li id='splistid"+d[a].id+"' class='mui-table-view-cell mui-media'><div style='float: left;'><img class='mui-media-object mui-pull-left' src='"+d[a].touxiang+"'><div class='mui-media-body'><font color='"+d[a].color+"'>"+d[a].name+"</font><p class='myp mui-ellipsis'>数量：<span>"+d[a].num+"</span>/<span>"+d[a].spnum+"</span></p></div></div><div style='float: right;'><div id='numbox"+d[a].id+"' class='mui-numbox' data-numbox-step='1' data-numbox-min='0' data-numbox-max='"+d[a].num+"'><button class='mui-btn mui-numbox-btn-minus' type='button'>-</button><input class='mui-numbox-input' type='number' /><button class='mui-btn mui-numbox-btn-plus' type='button'>+</button></div> <button type='button' class='imglibutton mui-btn' onclick='salesuipian("+d[a].id+","+d[a].pinji+")'>出售</button> <button type='button' class='imglibutton mui-btn' onclick='jnhecheng("+d[a].id+","+d[a].spnum+")'>合成</button></div></li>"}$("#splistul").empty();$("#splistul").html(c);mui(".mui-numbox").numbox()}})}function shangzhen(){mui.get("shangzhen",{"id":$("#jninfohideid").val()},function(a){if(a==0){getAndRenderDuiwu();mui.toast("上阵成功！")}else{if(a==-1){mui.toast("舰队人数已满6人！")}else{if(a==1){mui.toast("该舰娘已在队伍中！")}}}})}function jnxiuxi(a){mui.get("xiuxi",{"id":a},function(b){if(b==0){getAndRenderDuiwu();mui.toast("操作成功！")}})}function jninfoview(a){mui.get("showJnInfo",{"jnId":a},function(b){if(b){$("#jninfo_touxiang").attr("src",b.jn.touxiang);$("#jninfo_name").html("<font color='"+b.jn.color+"'>"+b.jn.name+"</font>");$("#jninfo_zdl").html(b.jn.zdl);$("#jninfo_id").html(b.jn.level);$("#jninfo_star").html(b.jn.star);$("#jninfo_gj").html(b.jn.gongji);$("#jninfo_fy").html(b.jn.fangyu);$("#jninfo_xl").html(b.jn.xueliang);$("#jninfo_sd").html(b.jn.sudu);$("#jninfo_bj").html(b.jn.baoji);$("#jninfo_db").html(b.jn.duobi);$("#jninfo_jy").html(b.jn.jingyan);$("#jninfo_sj").html(b.sj.needjy);$("#jninfo_lh").attr("src",b.jn.lihui);$("#jianduisx").hide();$("#jiannianginfo").show();$("#jninfohideid").val(b.jn.id)}})}function showjninfo2(a){mui.get("showJnInfo",{"jnId":a},function(b){if(b){$("#jninfo_touxiang2").attr("src",b.jn.touxiang);$("#jninfo_name2").html("<font color='"+b.jn.color+"'>"+b.jn.name+"</font>");$("#jninfo_zdl2").html(b.jn.zdl);$("#jninfo_id2").html(b.jn.level);$("#jninfo_star2").html(b.jn.star);$("#jninfo_gj2").html(b.jn.gongji);$("#jninfo_fy2").html(b.jn.fangyu);$("#jninfo_xl2").html(b.jn.xueliang);$("#jninfo_sd2").html(b.jn.sudu);$("#jninfo_bj2").html(b.jn.baoji);$("#jninfo_db2").html(b.jn.duobi);$("#jninfo_jy2").html(b.jn.jingyan);$("#jninfo_sj2").html(b.sj.needjy);$("#jninfo_lh2").attr("src",b.jn.lihui);if(b.jn.iswar==1){$("#jninfo_shangzhen2").hide()}else{$("#jninfo_shangzhen2").show()}$("#jnlistdiv").hide();$("#jiannianginfo2").show();$("#jninfohideid").val(b.jn.id)}})}function jnhecheng(b,a){mui.confirm("是否使用"+a+"个碎片(不足则使用布里碎片)合成？","提示",["取消","确定"],function(c){if(c.index==1){mui.get("jnHecheng",{"id":b},function(d){if(d==1){mui.toast("对应舰娘已存在！")}else{if(d==0){showsplist();mui.toast("恭喜你合成成功！")}else{mui.toast("碎片不足！")}}})}})}function gotomap(){$("#jianduiview").hide();$("#jianniangview").hide();$("#cangkuview").hide();$("#chujiview").show();$("#caidanview").hide();if(guajiid){location.href="#mapid_"+guajiid;window.scrollBy(0,-95)}}function showcaidanview(){$("#jianduiview").hide();$("#jianniangview").hide();$("#cangkuview").hide();$("#chujiview").hide();$("#caidanview").show()}function jninfo_back(){$("#jiannianginfo").hide();$("#jianduisx").show()}function jninfo_back2(){$("#jiannianginfo2").hide();$("#jnlistdiv").show()}function formatDate(a){var b=new Date(a);var g=b.getFullYear(),f=b.getMonth()+1,h=b.getDate(),c=b.getHours(),d=b.getMinutes(),e=b.getSeconds();var i=g+"-"+f+"-"+h+" "+c+":"+d+":"+e;return i}function salesuipianexist(){mui.confirm("确定要出售所有已拥有舰娘的碎片换取魔方？","提示",["取消","确定"],function(a){if(a.index==1){$("#btn_exist").attr("disabled",true);mui.get("saleSuipianExist",function(b){if(b>0){var c="<font color='gold'>获得魔方"+b+"个</font>";mui.toast(c,{duration:"long",type:"div"})}else{var c="<font color='red'>没有要出售的碎片</font>";mui.toast(c,{duration:"long",type:"div"})}$("#btn_exist").attr("disabled",false)})}})}function salesuipianfull(){mui.confirm("确定要出售所有满破舰娘的碎片换取魔方？","提示",["取消","确定"],function(a){if(a.index==1){$("#btn_full").attr("disabled",true);mui.get("saleSuipianFull",function(b){if(b>0){var c="<font color='gold'>获得魔方"+b+"个</font>";mui.toast(c,{duration:"long",type:"div"})}else{var c="<font color='red'>没有要出售的碎片</font>";mui.toast(c,{duration:"long",type:"div"})}$("#btn_full").attr("disabled",false)})}})}function qiandao(){mui.get("qiandao",function(b){if(b.hr==0){var c="<font color='yellow'>签到成功！</font><br/><font color='white'>恭喜您获得以下奖励：</font><br/><font color='red'>钻石："+b.data.zuanshi+"个</font><br/><font color='green;'>魔方："+b.data.mofang+"个</font><br/><font color='white'>石油："+b.data.shiyou+"点</font>";if(b.data.sps){for(var a=0;a<b.data.sps.length;a++){c=c+"<br/><font color='"+b.data.sps[a].color+"'>"+b.data.sps[a].name+"碎片："+b.data.sps[a].num+"个</font>"
}}$("#zs_num").html(parseInt($("#zs_num").html())+b.data.zuanshi);mui.toast(c,{duration:"long",type:"div"})}else{mui.toast("今日已签到！")}})}function jianzao(){mui.get("jianzao",function(a){if(a.hr==0){var b="建造成功！<br/><font color='"+a.data.color+"'>"+a.data.name+"碎片："+a.data.num+"个</font>";mui.toast(b,{duration:"long",type:"div"});$("#wz_num").html(parseInt($("#wz_num").html())-1000)}else{if(a.hr==1){mui.toast("物资不足!")}else{if(a.hr==-1){mui.toast("魔方不足")}}}})}function gjjianzao(){mui.get("gjJianzao",function(a){if(a.hr==0){var b="建造成功！<br/><font color='"+a.data.color+"'>"+a.data.name+"碎片："+a.data.num+"个</font>";mui.toast(b,{duration:"long",type:"div"});$("#wz_num").html(parseInt($("#wz_num").html())-3000)}else{if(a.hr==1){mui.toast("物资不足!")}else{if(a.hr==-1){mui.toast("魔方不足")}}}})}function paihangbang(){$("#menus").hide();$("#phb").show();getphbinfo($("input[name='phbtype']:checked").val())}function back_phb(){$("#phb").hide();$("#menus").show()}function getphbinfo(a){mui.get("phb",{"type":a},function(c){if(c){var d="";if(a=="a"){for(var b=0;b<c.length;b++){d=d+"<li class='mui-table-view-cell mui-media'><div style='float: left;'><img class='mui-media-object mui-pull-left' src='"+c[b].tx+"'><div class='mui-media-body'><font color='gold'>"+c[b].name+"</font><p class='myp mui-ellipsis'>第"+(b+1)+"名 Lv."+c[b].num+"</p></div></div></li>"}}else{if(a=="b"){for(var b=0;b<c.length;b++){d=d+"<li class='mui-table-view-cell mui-media'><div style='float: left;'><img class='mui-media-object mui-pull-left' src='"+c[b].tx+"'><div class='mui-media-body'><font color='gold'>"+c[b].name+"</font><p class='myp mui-ellipsis'>第"+(b+1)+"名 战斗力："+c[b].num+"</p></div></div></li>"}}else{if(a=="c"){for(var b=0;b<c.length;b++){d=d+"<li class='mui-table-view-cell mui-media'><div style='float: left;'><img class='mui-media-object mui-pull-left' src='"+c[b].tx+"'><div class='mui-media-body'><font color='gold'>"+c[b].name+"</font><p class='myp mui-ellipsis'>第"+(b+1)+"名 图鉴数："+c[b].num+"个</p></div></div></li>"}}else{if(a=="d"){for(var b=0;b<c.length;b++){d=d+"<li class='mui-table-view-cell mui-media'><div style='float: left;'><img class='mui-media-object mui-pull-left' src='"+c[b].tx+"'><div class='mui-media-body'><font color='"+c[b].color+"'>"+c[b].name+"</font><p class='myp mui-ellipsis'>第"+(b+1)+"名 <font color='cyan'>战斗力："+c[b].num+"</font>  <font color='gold'>"+c[b].label+"</font></p></div></div></li>"}}}}}$("#phbul").empty();$("#phbul").html(d)}})}function getlosejn(){$("#menus").hide();$("#losejn").show();mui.get("getLoseJn",function(b){if(b){var c="";if(b.length>0){for(var a=0;a<b.length;a++){c=c+"<font color = "+b[a].color+">"+b[a].name+"</font><br/>"}}else{c="<font color='Gold'>恭喜您已解锁全部舰娘!</font>"}$("#losejnul").html(c)}})}function back_losejn(){$("#losejn").hide();$("#menus").show()}function changetouxiang(){mui.post("changeTouxiang",{"id":$("#jninfohideid").val()},function(a){if(a){$("#roletouxiang").attr("src",a);mui.toast("设置成功！")}})}function zuanshisd(){mui.get("zuanshisd",function(a){if(a==0){mui.toast("购买成功！");$("#zs_num").html(parseInt($("#zs_num").html())-50)}else{mui.toast("砖石不足！")}})}function salemofang(){mui.get("saleMofang",function(a){if(a==0){$("#wz_num").html(parseInt($("#wz_num").html())+160000);mui.toast("兑换成功！")}else{mui.toast("魔方不足！")}})}function buymofang(){mui.get("buyMofang",function(a){if(a==0){$("#wz_num").html(parseInt($("#wz_num").html())-200000);mui.toast("购买成功！")}else{mui.toast("物资不足！")}})}function salezbl(){mui.get("saleZbl",function(a){if(a==0){mui.toast("兑换成功！")}else{mui.toast("紫布里不足！")}})}function dhzbl(){mui.get("dhZbl",function(a){if(a==0){mui.toast("兑换成功！")}else{mui.toast("魔方不足！")}})}function jnshengxing(a){mui.confirm("是否使用对应舰娘碎片(不足则使用布里碎片)进行升星？","提示",["取消","确定"],function(b){if(b.index==1){mui.get("jnShengxing",{"id":$("#jninfohideid").val()},function(c){if(c==0){mui.toast("升星成功！");renderRoleDuiwu()}else{if(c==-1){mui.toast("物资不足!")}else{if(c.result=="defaultsp"){mui.toast("碎片不足")}else{if(c==1){mui.toast("已达到最大星级！")}}}}})}})}function openkeyanview(){mui.get("keyanData",function(a){if(a){$("#gjdj").html(a.gjdj);$("#fydj").html(a.fydj);$("#xldj").html(a.xldj);$("#sddj").html(a.sddj);$("#bjdj").html(a.bjdj);$("#dbdj").html(a.dbdj);$("#gjky").html(allKeyanSJ[a.gjdj].needjy);$("#fyky").html(allKeyanSJ[a.fydj].needjy);$("#xlky").html(allKeyanSJ[a.xldj].needjy);$("#sdky").html(allKeyanSJ[a.sddj].needjy);$("#bjky").html(allKeyanSJ[a.bjdj].needjy);$("#dbky").html(allKeyanSJ[a.dbdj].needjy);$("#gjwz").html(allKeyanSJ[a.gjdj].needwz);$("#fywz").html(allKeyanSJ[a.fydj].needwz);$("#xlwz").html(allKeyanSJ[a.xldj].needwz);$("#sdwz").html(allKeyanSJ[a.sddj].needwz);$("#bjwz").html(allKeyanSJ[a.bjdj].needwz);$("#dbwz").html(allKeyanSJ[a.dbdj].needwz);$("#jianduisx").hide();$("#keyanview").show()}})}function keyan_back(){$("#keyanview").hide();$("#jianduisx").show()}function keyansj(a){mui.get("keyanSj",{"type":a},function(b){if(b==0){mui.toast("升级成功！");openkeyanview();renderRoleDuiwu()}else{if(b==1){mui.toast("已达等级上限！")}else{mui.toast("所需资源不足！")
}}})};